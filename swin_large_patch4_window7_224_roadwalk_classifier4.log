Using device: cuda
Training directories: ['/workspace/hf_extracted_images', '/workspace/synthetic', '/workspace/synthetic1', '/workspace/synthetic2']
Models to train: ['swin_large_patch4_window7_224']
Total samples: 55616, Train: 50054, Val: 5562

=== Training model: swin_large_patch4_window7_224 ===
TensorBoard logs -> tb_logs/swin_large_patch4_window7_224_20251021_160831
Resuming training from checkpoint: checkpoints/swin_large_patch4_window7_224_best.pth
Starting DANN pretraining for 10 epochs
[DANN pretrain 1/10] train_f1=0.8207 train_acc=0.8209 train_loss=0.4655 | val_acc=0.8294 val_loss=0.3757
Saved best pretrain checkpoint -> checkpoints/swin_large_patch4_window7_224_best.pth
[DANN pretrain 2/10] train_f1=0.8242 train_acc=0.8246 train_loss=0.4504 | val_acc=0.8299 val_loss=0.3732
Saved best pretrain checkpoint -> checkpoints/swin_large_patch4_window7_224_best.pth
[DANN pretrain 3/10] train_f1=0.8242 train_acc=0.8248 train_loss=0.4409 | val_acc=0.8285 val_loss=0.3683
[DANN pretrain 4/10] train_f1=0.8241 train_acc=0.8253 train_loss=0.4390 | val_acc=0.8321 val_loss=0.3653
Saved best pretrain checkpoint -> checkpoints/swin_large_patch4_window7_224_best.pth
[DANN pretrain 5/10] train_f1=0.8254 train_acc=0.8269 train_loss=0.4327 | val_acc=0.8306 val_loss=0.3660
[DANN pretrain 6/10] train_f1=0.8233 train_acc=0.8245 train_loss=0.4308 | val_acc=0.8303 val_loss=0.3675
[DANN pretrain 7/10] train_f1=0.8239 train_acc=0.8255 train_loss=0.4308 | val_acc=0.8303 val_loss=0.3658
[DANN pretrain 8/10] train_f1=0.8227 train_acc=0.8246 train_loss=0.4268 | val_acc=0.8306 val_loss=0.3651
[DANN pretrain 9/10] train_f1=0.8244 train_acc=0.8263 train_loss=0.4260 | val_acc=0.8296 val_loss=0.3633
[DANN pretrain 10/10] train_f1=0.8237 train_acc=0.8258 train_loss=0.4251 | val_acc=0.8279 val_loss=0.3613
Starting supervised training for 50 epochs
[Epoch 1/50] Train Acc: 0.8261, Loss: 0.1602 | Val Acc: 0.8296, Loss: 0.3610 Total Acc: 0.8279
Saved new best checkpoint -> checkpoints/swin_large_patch4_window7_224_best.pth
[Epoch 2/50] Train Acc: 0.8243, Loss: 0.1588 | Val Acc: 0.8299, Loss: 0.3596 Total Acc: 0.8271
[Epoch 3/50] Train Acc: 0.8275, Loss: 0.1541 | Val Acc: 0.8342, Loss: 0.3569 Total Acc: 0.8309
Saved new best checkpoint -> checkpoints/swin_large_patch4_window7_224_best.pth
[Epoch 4/50] Train Acc: 0.8260, Loss: 0.1507 | Val Acc: 0.8335, Loss: 0.3631 Total Acc: 0.8298
[Epoch 5/50] Train Acc: 0.8269, Loss: 0.1450 | Val Acc: 0.8319, Loss: 0.3599 Total Acc: 0.8294
[Epoch 6/50] Train Acc: 0.8256, Loss: 0.1378 | Val Acc: 0.8346, Loss: 0.3678 Total Acc: 0.8301
[Epoch 7/50] Train Acc: 0.8250, Loss: 0.1291 | Val Acc: 0.8310, Loss: 0.3711 Total Acc: 0.8280
[Epoch 8/50] Train Acc: 0.8240, Loss: 0.1221 | Val Acc: 0.8303, Loss: 0.3824 Total Acc: 0.8271
[Epoch 9/50] Train Acc: 0.8244, Loss: 0.1118 | Val Acc: 0.8321, Loss: 0.3892 Total Acc: 0.8282
[Epoch 10/50] Train Acc: 0.8235, Loss: 0.1067 | Val Acc: 0.8330, Loss: 0.4034 Total Acc: 0.8282
[Epoch 11/50] Train Acc: 0.8230, Loss: 0.1044 | Val Acc: 0.8348, Loss: 0.4160 Total Acc: 0.8289
[Epoch 12/50] Train Acc: 0.8231, Loss: 0.1024 | Val Acc: 0.8279, Loss: 0.4176 Total Acc: 0.8255
[Epoch 13/50] Train Acc: 0.8217, Loss: 0.1017 | Val Acc: 0.8369, Loss: 0.4247 Total Acc: 0.8293
[Epoch 14/50] Train Acc: 0.8203, Loss: 0.1008 | Val Acc: 0.8324, Loss: 0.4159 Total Acc: 0.8264
[Epoch 15/50] Train Acc: 0.8222, Loss: 0.0998 | Val Acc: 0.8301, Loss: 0.4264 Total Acc: 0.8262
[Epoch 16/50] Train Acc: 0.8231, Loss: 0.0989 | Val Acc: 0.8294, Loss: 0.4265 Total Acc: 0.8262
[Epoch 17/50] Train Acc: 0.8230, Loss: 0.0986 | Val Acc: 0.8337, Loss: 0.4265 Total Acc: 0.8283
[Epoch 18/50] Train Acc: 0.8225, Loss: 0.0989 | Val Acc: 0.8310, Loss: 0.4269 Total Acc: 0.8268
[Epoch 19/50] Train Acc: 0.8235, Loss: 0.0983 | Val Acc: 0.8335, Loss: 0.4228 Total Acc: 0.8285
[Epoch 20/50] Train Acc: 0.8234, Loss: 0.0974 | Val Acc: 0.8281, Loss: 0.4185 Total Acc: 0.8257
[Epoch 21/50] Train Acc: 0.8217, Loss: 0.0978 | Val Acc: 0.8350, Loss: 0.4129 Total Acc: 0.8283
[Epoch 22/50] Train Acc: 0.8243, Loss: 0.0973 | Val Acc: 0.8312, Loss: 0.4109 Total Acc: 0.8277
[Epoch 23/50] Train Acc: 0.8230, Loss: 0.0975 | Val Acc: 0.8319, Loss: 0.4179 Total Acc: 0.8275
[Epoch 24/50] Train Acc: 0.8246, Loss: 0.0971 | Val Acc: 0.8373, Loss: 0.4300 Total Acc: 0.8310
Saved new best checkpoint -> checkpoints/swin_large_patch4_window7_224_best.pth
[Epoch 25/50] Train Acc: 0.8251, Loss: 0.0967 | Val Acc: 0.8299, Loss: 0.4171 Total Acc: 0.8275
[Epoch 26/50] Train Acc: 0.8231, Loss: 0.0973 | Val Acc: 0.8242, Loss: 0.4207 Total Acc: 0.8236
[Epoch 27/50] Train Acc: 0.8244, Loss: 0.0969 | Val Acc: 0.8333, Loss: 0.4166 Total Acc: 0.8289
[Epoch 28/50] Train Acc: 0.8269, Loss: 0.0958 | Val Acc: 0.8355, Loss: 0.4188 Total Acc: 0.8312
Saved new best checkpoint -> checkpoints/swin_large_patch4_window7_224_best.pth
[Epoch 29/50] Train Acc: 0.8251, Loss: 0.0961 | Val Acc: 0.8276, Loss: 0.4194 Total Acc: 0.8264
[Epoch 30/50] Train Acc: 0.8226, Loss: 0.0961 | Val Acc: 0.8326, Loss: 0.4137 Total Acc: 0.8276
[Epoch 31/50] Train Acc: 0.8242, Loss: 0.0962 | Val Acc: 0.8350, Loss: 0.4172 Total Acc: 0.8296
[Epoch 32/50] Train Acc: 0.8250, Loss: 0.0961 | Val Acc: 0.8312, Loss: 0.4111 Total Acc: 0.8281
[Epoch 33/50] Train Acc: 0.8246, Loss: 0.0955 | Val Acc: 0.8337, Loss: 0.4120 Total Acc: 0.8291
[Epoch 34/50] Train Acc: 0.8255, Loss: 0.0952 | Val Acc: 0.8306, Loss: 0.4174 Total Acc: 0.8281
[Epoch 35/50] Train Acc: 0.8236, Loss: 0.0958 | Val Acc: 0.8323, Loss: 0.4150 Total Acc: 0.8279
[Epoch 36/50] Train Acc: 0.8241, Loss: 0.0959 | Val Acc: 0.8317, Loss: 0.4165 Total Acc: 0.8279
