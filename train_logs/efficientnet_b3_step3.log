Using device: cuda
Training path: config/train.txt
Validation path: config/val.txt
Model to train: efficientnet_b3
Total samples: 50048, Train: 44490, Val: 5558

=== Training model: efficientnet_b3 ===
Feature dimension: 1536
[INFO] Class distribution in training set:
 - Class 0: 20534 samples
 - Class 1: 23956 samples
TensorBoard logs -> tb_logs/efficientnet_b3_20251106_021125
Resuming training from checkpoint: checkpoints/efficientnet_b3_best.pth
Starting DANN pretraining for 8 epochs
[DANN pretrain 1/8] train_f1=0.9555 train_acc=0.9423 train_loss=0.7735 | val_acc=0.8970 val_loss=0.3546
Saved best pretrain checkpoint -> checkpoints/efficientnet_b3_best.pth
[DANN pretrain 2/8] train_f1=0.9582 train_acc=0.9459 train_loss=0.8194 | val_acc=0.8947 val_loss=0.3596
[DANN pretrain 3/8] train_f1=0.9592 train_acc=0.9471 train_loss=0.8099 | val_acc=0.8919 val_loss=0.3718
No progress in validation for 5 epochs, stopping DANN pretraining early.
Starting supervised training for 20 epochs
[Epoch 1/20] Train Acc: 0.8896, Loss: 0.2908 | Val Acc: 0.8975, Loss: 0.2649 Total Acc: 0.8359
Saved new best checkpoint -> checkpoints/efficientnet_b3_best.pth
[Epoch 2/20] Train Acc: 0.8856, Loss: 0.2795 | Val Acc: 0.8972, Loss: 0.2615 Total Acc: 0.8353
[Epoch 3/20] Train Acc: 0.8968, Loss: 0.2773 | Val Acc: 0.9007, Loss: 0.2709 Total Acc: 0.8420
Saved new best checkpoint -> checkpoints/efficientnet_b3_best.pth
[Epoch 4/20] Train Acc: 0.8805, Loss: 0.2927 | Val Acc: 0.9011, Loss: 0.2728 Total Acc: 0.8432
Saved new best checkpoint -> checkpoints/efficientnet_b3_best.pth
[Epoch 5/20] Train Acc: 0.8903, Loss: 0.2894 | Val Acc: 0.8979, Loss: 0.2593 Total Acc: 0.8382
[Epoch 6/20] Train Acc: 0.8832, Loss: 0.2937 | Val Acc: 0.8988, Loss: 0.2774 Total Acc: 0.8385
No progress in validation for 2 epochs, stopping training early.
Model efficientnet_b3 best checkpoint saved at: checkpoints/efficientnet_b3_best.pth
