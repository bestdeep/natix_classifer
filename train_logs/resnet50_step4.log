Using device: cuda
Training path: config/train.txt
Validation path: config/val.txt
Model to train: resnet50
Total samples: 50048, Train: 44490, Val: 5558

=== Training model: resnet50 ===
Feature dimension: 2048
[INFO] Class distribution in training set:
 - Class 0: 20534 samples
 - Class 1: 23956 samples
TensorBoard logs -> tb_logs/resnet50_20251101_020842
Resuming training from checkpoint: checkpoints/resnet50_best.pth
Starting DANN pretraining for 8 epochs
[DANN pretrain 1/8] train_f1=0.9774 train_acc=0.9704 train_loss=0.7660 | val_acc=0.8833 val_loss=0.4655
Saved best pretrain checkpoint -> checkpoints/resnet50_best.pth
[DANN pretrain 2/8] train_f1=0.9786 train_acc=0.9721 train_loss=0.7591 | val_acc=0.8820 val_loss=0.4937
[DANN pretrain 3/8] train_f1=0.9791 train_acc=0.9727 train_loss=0.7571 | val_acc=0.8833 val_loss=0.4908
Saved best pretrain checkpoint -> checkpoints/resnet50_best.pth
[DANN pretrain 4/8] train_f1=0.9767 train_acc=0.9695 train_loss=0.7664 | val_acc=0.8843 val_loss=0.4633
[DANN pretrain 5/8] train_f1=0.9732 train_acc=0.9650 train_loss=0.7762 | val_acc=0.8872 val_loss=0.4267
Saved best pretrain checkpoint -> checkpoints/resnet50_best.pth
[DANN pretrain 6/8] train_f1=0.9740 train_acc=0.9660 train_loss=0.7727 | val_acc=0.8859 val_loss=0.4626
[DANN pretrain 7/8] train_f1=0.9750 train_acc=0.9674 train_loss=0.7707 | val_acc=0.8862 val_loss=0.4755
No progress in validation for 5 epochs, stopping DANN pretraining early.
Starting supervised training for 20 epochs
[Epoch 1/20] Train Acc: 0.9094, Loss: 0.2496 | Val Acc: 0.8934, Loss: 0.2714 Total Acc: 0.8314
Saved new best checkpoint -> checkpoints/resnet50_best.pth
[Epoch 2/20] Train Acc: 0.8901, Loss: 0.2749 | Val Acc: 0.8886, Loss: 0.3121 Total Acc: 0.8240
[Epoch 3/20] Train Acc: 0.9030, Loss: 0.2611 | Val Acc: 0.8918, Loss: 0.2889 Total Acc: 0.8290
No progress in validation for 2 epochs, stopping training early.
Model resnet50 best checkpoint saved at: checkpoints/resnet50_best.pth
