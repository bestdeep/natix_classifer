Using device: cuda
Training path: config/train.txt
Validation path: config/val.txt
Model to train: efficientnet_b3
Total samples: 50048, Train: 44490, Val: 5558

=== Training model: efficientnet_b3 ===
Feature dimension: 1536
[INFO] Class distribution in training set:
 - Class 0: 20534 samples
 - Class 1: 23956 samples
TensorBoard logs -> tb_logs/efficientnet_b3_20251104_185827
Resuming training from checkpoint: checkpoints/efficientnet_b3_best.pth
Starting DANN pretraining for 8 epochs
[DANN pretrain 1/8] train_f1=0.9308 train_acc=0.9113 train_loss=0.7804 | val_acc=0.8997 val_loss=0.2793
Saved best pretrain checkpoint -> checkpoints/efficientnet_b3_best.pth
[DANN pretrain 2/8] train_f1=0.9308 train_acc=0.9109 train_loss=0.8688 | val_acc=0.8956 val_loss=0.2712
[DANN pretrain 3/8] train_f1=0.9311 train_acc=0.9118 train_loss=0.8781 | val_acc=0.9002 val_loss=0.2778
Saved best pretrain checkpoint -> checkpoints/efficientnet_b3_best.pth
[DANN pretrain 4/8] train_f1=0.9327 train_acc=0.9135 train_loss=0.8671 | val_acc=0.8945 val_loss=0.2919
[DANN pretrain 5/8] train_f1=0.9350 train_acc=0.9166 train_loss=0.8587 | val_acc=0.8937 val_loss=0.3189
No progress in validation for 5 epochs, stopping DANN pretraining early.
Starting supervised training for 20 epochs
[Epoch 1/20] Train Acc: 0.8670, Loss: 0.3445 | Val Acc: 0.9034, Loss: 0.2748 Total Acc: 0.8461
Saved new best checkpoint -> checkpoints/efficientnet_b3_best.pth
[Epoch 2/20] Train Acc: 0.8636, Loss: 0.3288 | Val Acc: 0.9015, Loss: 0.2865 Total Acc: 0.8433
[Epoch 3/20] Train Acc: 0.8736, Loss: 0.3172 | Val Acc: 0.9041, Loss: 0.2816 Total Acc: 0.8474
Saved new best checkpoint -> checkpoints/efficientnet_b3_best.pth
[Epoch 4/20] Train Acc: 0.8691, Loss: 0.3136 | Val Acc: 0.9042, Loss: 0.2705 Total Acc: 0.8484
Saved new best checkpoint -> checkpoints/efficientnet_b3_best.pth
[Epoch 5/20] Train Acc: 0.8799, Loss: 0.3127 | Val Acc: 0.9025, Loss: 0.2710 Total Acc: 0.8450
[Epoch 6/20] Train Acc: 0.8732, Loss: 0.3073 | Val Acc: 0.9018, Loss: 0.2792 Total Acc: 0.8445
No progress in validation for 2 epochs, stopping training early.
Model efficientnet_b3 best checkpoint saved at: checkpoints/efficientnet_b3_best.pth
