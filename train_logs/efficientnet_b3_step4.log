Using device: cuda
Training path: config/train.txt
Validation path: config/val.txt
Model to train: efficientnet_b3
Total samples: 50048, Train: 44490, Val: 5558

=== Training model: efficientnet_b3 ===
Feature dimension: 1536
[INFO] Class distribution in training set:
 - Class 0: 20534 samples
 - Class 1: 23956 samples
TensorBoard logs -> tb_logs/efficientnet_b3_20251106_162205
Resuming training from checkpoint: checkpoints/efficientnet_b3_best.pth
Starting DANN pretraining for 8 epochs
[DANN pretrain 1/8] train_f1=0.9677 train_acc=0.9579 train_loss=0.7525 | val_acc=0.8947 val_loss=0.4191
Saved best pretrain checkpoint -> checkpoints/efficientnet_b3_best.pth
[DANN pretrain 2/8] train_f1=0.9708 train_acc=0.9621 train_loss=0.7809 | val_acc=0.8888 val_loss=0.4913
[DANN pretrain 3/8] train_f1=0.9715 train_acc=0.9629 train_loss=0.7765 | val_acc=0.8915 val_loss=0.4981
No progress in validation for 5 epochs, stopping DANN pretraining early.
Starting supervised training for 20 epochs
[Epoch 1/20] Train Acc: 0.9028, Loss: 0.2641 | Val Acc: 0.8970, Loss: 0.2723 Total Acc: 0.8363
Saved new best checkpoint -> checkpoints/efficientnet_b3_best.pth
[Epoch 2/20] Train Acc: 0.8994, Loss: 0.2525 | Val Acc: 0.8938, Loss: 0.2661 Total Acc: 0.8292
[Epoch 3/20] Train Acc: 0.9103, Loss: 0.2501 | Val Acc: 0.8990, Loss: 0.2755 Total Acc: 0.8387
Saved new best checkpoint -> checkpoints/efficientnet_b3_best.pth
[Epoch 4/20] Train Acc: 0.8941, Loss: 0.2654 | Val Acc: 0.8978, Loss: 0.2709 Total Acc: 0.8375
[Epoch 5/20] Train Acc: 0.8956, Loss: 0.2816 | Val Acc: 0.8973, Loss: 0.2639 Total Acc: 0.8362
No progress in validation for 2 epochs, stopping training early.
Model efficientnet_b3 best checkpoint saved at: checkpoints/efficientnet_b3_best.pth
