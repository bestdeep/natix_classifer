Using device: cuda
Training directories: ['/workspace/hf_extracted_images/train', '/workspace/hf_extracted_images/test', '/workspace/synthetic/i2i', '/workspace/synthetic/t2i']
Models to train: ['efficientnetv2_s', 'resnet18', 'resnet50']
Total samples: 21919, Train: 19727, Val: 2192

=== Training model: efficientnetv2_s ===
Error occurred while building model: No pretrained weights exist for efficientnetv2_s. Use `pretrained=False` for random init.
[1/20] Train Acc: 0.5392, Loss: 0.6501, Val Acc: 0.4129, Loss: 1.0257
[2/20] Train Acc: 0.5786, Loss: 0.2809, Val Acc: 0.6045, Loss: 0.9526
[3/20] Train Acc: 0.6277, Loss: 0.2212, Val Acc: 0.6337, Loss: 0.9433
[4/20] Train Acc: 0.6446, Loss: 0.1967, Val Acc: 0.6825, Loss: 1.3875
[5/20] Train Acc: 0.6611, Loss: 0.1818, Val Acc: 0.7140, Loss: 0.7119
[6/20] Train Acc: 0.6687, Loss: 0.1692, Val Acc: 0.7322, Loss: 0.6889
[7/20] Train Acc: 0.6810, Loss: 0.1559, Val Acc: 0.7614, Loss: 0.7098
[8/20] Train Acc: 0.6926, Loss: 0.1486, Val Acc: 0.7883, Loss: 0.5897
[9/20] Train Acc: 0.6925, Loss: 0.1425, Val Acc: 0.7961, Loss: 0.6411
[10/20] Train Acc: 0.7112, Loss: 0.1331, Val Acc: 0.8161, Loss: 1.0246
[11/20] Train Acc: 0.7092, Loss: 0.1333, Val Acc: 0.8107, Loss: 0.5652
[12/20] Train Acc: 0.7201, Loss: 0.1233, Val Acc: 0.8244, Loss: 1.6742
[13/20] Train Acc: 0.7395, Loss: 0.1228, Val Acc: 0.8276, Loss: 0.5604
[14/20] Train Acc: 0.7286, Loss: 0.1209, Val Acc: 0.8390, Loss: 0.5248
[15/20] Train Acc: 0.7342, Loss: 0.1193, Val Acc: 0.8317, Loss: 0.5480
[16/20] Train Acc: 0.7436, Loss: 0.1141, Val Acc: 0.8449, Loss: 0.4855
[17/20] Train Acc: 0.7340, Loss: 0.1128, Val Acc: 0.8376, Loss: 0.5134
[18/20] Train Acc: 0.7394, Loss: 0.1121, Val Acc: 0.8549, Loss: 0.5097
[19/20] Train Acc: 0.7487, Loss: 0.1100, Val Acc: 0.8508, Loss: 0.4978
[20/20] Train Acc: 0.7433, Loss: 0.1099, Val Acc: 0.8650, Loss: 0.4796
Model efficientnetv2_s best checkpoint saved at: checkpoints/efficientnetv2_s_best.pth

=== Training model: resnet18 ===
Downloading: "https://download.pytorch.org/models/resnet18-f37072fd.pth" to /root/.cache/torch/hub/checkpoints/resnet18-f37072fd.pth
[1/20] Train Acc: 0.7617, Loss: 0.1175, Val Acc: 0.8791, Loss: 0.3898
[2/20] Train Acc: 0.7835, Loss: 0.0956, Val Acc: 0.9069, Loss: 0.4140
[3/20] Train Acc: 0.7966, Loss: 0.0934, Val Acc: 0.8919, Loss: 0.3700
[4/20] Train Acc: 0.7804, Loss: 0.0927, Val Acc: 0.9183, Loss: 0.3462
[5/20] Train Acc: 0.8016, Loss: 0.0871, Val Acc: 0.9051, Loss: 0.3694
[6/20] Train Acc: 0.7814, Loss: 0.0876, Val Acc: 0.9138, Loss: 0.3666
[7/20] Train Acc: 0.7982, Loss: 0.0840, Val Acc: 0.9165, Loss: 0.3953
[8/20] Train Acc: 0.8082, Loss: 0.0814, Val Acc: 0.9106, Loss: 0.3647
[9/20] Train Acc: 0.8037, Loss: 0.0787, Val Acc: 0.9188, Loss: 0.3895
[10/20] Train Acc: 0.8109, Loss: 0.0773, Val Acc: 0.9124, Loss: 0.3600
[11/20] Train Acc: 0.8042, Loss: 0.0737, Val Acc: 0.9252, Loss: 0.3565
[12/20] Train Acc: 0.8054, Loss: 0.0748, Val Acc: 0.9229, Loss: 0.3713
[13/20] Train Acc: 0.7955, Loss: 0.0700, Val Acc: 0.9302, Loss: 0.3606
[14/20] Train Acc: 0.8292, Loss: 0.0669, Val Acc: 0.9279, Loss: 0.3550
[15/20] Train Acc: 0.8232, Loss: 0.0638, Val Acc: 0.9302, Loss: 0.3405
[16/20] Train Acc: 0.8077, Loss: 0.0625, Val Acc: 0.9389, Loss: 0.3010
[17/20] Train Acc: 0.8245, Loss: 0.0621, Val Acc: 0.9329, Loss: 0.3277
[18/20] Train Acc: 0.8171, Loss: 0.0605, Val Acc: 0.9316, Loss: 0.3066
[19/20] Train Acc: 0.8071, Loss: 0.0609, Val Acc: 0.9361, Loss: 0.2908
[20/20] Train Acc: 0.8122, Loss: 0.0590, Val Acc: 0.9339, Loss: 0.3048
Model resnet18 best checkpoint saved at: checkpoints/resnet18_best.pth

=== Training model: resnet50 ===
Downloading: "https://download.pytorch.org/models/resnet50-0676ba61.pth" to /root/.cache/torch/hub/checkpoints/resnet50-0676ba61.pth
[1/20] Train Acc: 0.7585, Loss: 0.1099, Val Acc: 0.8987, Loss: 0.3762
[2/20] Train Acc: 0.7821, Loss: 0.0979, Val Acc: 0.8964, Loss: 0.3842
[3/20] Train Acc: 0.7766, Loss: 0.0953, Val Acc: 0.8992, Loss: 0.4158
[4/20] Train Acc: 0.7997, Loss: 0.0897, Val Acc: 0.9161, Loss: 0.4076
[5/20] Train Acc: 0.7817, Loss: 0.0855, Val Acc: 0.9042, Loss: 0.3282
[6/20] Train Acc: 0.7826, Loss: 0.0863, Val Acc: 0.9138, Loss: 0.3556
[7/20] Train Acc: 0.7893, Loss: 0.0836, Val Acc: 0.8964, Loss: 0.3947
[8/20] Train Acc: 0.7929, Loss: 0.0813, Val Acc: 0.9211, Loss: 0.3520
[9/20] Train Acc: 0.7950, Loss: 0.0815, Val Acc: 0.9197, Loss: 0.3358
[10/20] Train Acc: 0.8104, Loss: 0.0776, Val Acc: 0.9339, Loss: 0.3286
[11/20] Train Acc: 0.8136, Loss: 0.0790, Val Acc: 0.9288, Loss: 0.3217
[12/20] Train Acc: 0.8300, Loss: 0.0723, Val Acc: 0.9256, Loss: 0.3501
[13/20] Train Acc: 0.8215, Loss: 0.0722, Val Acc: 0.9288, Loss: 0.3567
[14/20] Train Acc: 0.8203, Loss: 0.0677, Val Acc: 0.9297, Loss: 0.3925
[15/20] Train Acc: 0.8319, Loss: 0.0667, Val Acc: 0.9316, Loss: 0.3727
[16/20] Train Acc: 0.8185, Loss: 0.0606, Val Acc: 0.9389, Loss: 0.3040
[17/20] Train Acc: 0.8236, Loss: 0.0638, Val Acc: 0.9398, Loss: 0.2643
[18/20] Train Acc: 0.8322, Loss: 0.0575, Val Acc: 0.9352, Loss: 0.2688
[19/20] Train Acc: 0.8439, Loss: 0.0582, Val Acc: 0.9398, Loss: 0.2515
[20/20] Train Acc: 0.8469, Loss: 0.0613, Val Acc: 0.9370, Loss: 0.2942
Model resnet50 best checkpoint saved at: checkpoints/resnet50_best.pth
