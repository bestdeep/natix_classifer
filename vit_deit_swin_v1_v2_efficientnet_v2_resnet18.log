Using device: cuda
Training directories: ['/workspace/hf_extracted_images/train', '/workspace/hf_extracted_images/test', '/workspace/synthetic/i2i', '/workspace/synthetic/t2i']
Models to train: ['vit_base', 'deit_small', 'swin_small', 'swin_v2_small', 'efficientnetv2_s', 'resnet18']
Total samples: 21919, Train: 19727, Val: 2192

=== Training model: vit_base ===
[1/20] Train Acc: 0.6173, Loss: 0.2078, Val Acc: 0.6834, Loss: 0.5629
[2/20] Train Acc: 0.7045, Loss: 0.1344, Val Acc: 0.8189, Loss: 0.5125
[3/20] Train Acc: 0.7402, Loss: 0.1207, Val Acc: 0.8435, Loss: 0.5037
[4/20] Train Acc: 0.7405, Loss: 0.1140, Val Acc: 0.8695, Loss: 0.4700
[5/20] Train Acc: 0.7643, Loss: 0.1112, Val Acc: 0.8645, Loss: 0.4394
[6/20] Train Acc: 0.7527, Loss: 0.1087, Val Acc: 0.8540, Loss: 0.4838
[7/20] Train Acc: 0.7609, Loss: 0.1052, Val Acc: 0.8777, Loss: 0.4339
[8/20] Train Acc: 0.7682, Loss: 0.1044, Val Acc: 0.8841, Loss: 0.4746
[9/20] Train Acc: 0.7609, Loss: 0.1005, Val Acc: 0.8978, Loss: 0.4149
[10/20] Train Acc: 0.7685, Loss: 0.1002, Val Acc: 0.8891, Loss: 0.4015
[11/20] Train Acc: 0.7730, Loss: 0.0980, Val Acc: 0.8928, Loss: 0.4244
[12/20] Train Acc: 0.7795, Loss: 0.0949, Val Acc: 0.8937, Loss: 0.4291
[13/20] Train Acc: 0.7986, Loss: 0.0958, Val Acc: 0.9060, Loss: 0.3901
[14/20] Train Acc: 0.7758, Loss: 0.0962, Val Acc: 0.9097, Loss: 0.3787
[15/20] Train Acc: 0.7917, Loss: 0.0918, Val Acc: 0.9024, Loss: 0.4014
[16/20] Train Acc: 0.8026, Loss: 0.0862, Val Acc: 0.9124, Loss: 0.3416
[17/20] Train Acc: 0.7881, Loss: 0.0860, Val Acc: 0.9106, Loss: 0.3486
[18/20] Train Acc: 0.7870, Loss: 0.0875, Val Acc: 0.9147, Loss: 0.3569
[19/20] Train Acc: 0.8018, Loss: 0.0815, Val Acc: 0.9065, Loss: 0.3541
[20/20] Train Acc: 0.8015, Loss: 0.0810, Val Acc: 0.9179, Loss: 0.3538
Model vit_base best checkpoint saved at: checkpoints/vit_base_best.pth

=== Training model: deit_small ===
[1/20] Train Acc: 0.7574, Loss: 0.1162, Val Acc: 0.8782, Loss: 0.3728
[2/20] Train Acc: 0.7792, Loss: 0.0961, Val Acc: 0.9028, Loss: 0.4005
[3/20] Train Acc: 0.8043, Loss: 0.0888, Val Acc: 0.9092, Loss: 0.3613
[4/20] Train Acc: 0.7835, Loss: 0.0900, Val Acc: 0.9179, Loss: 0.3186
[5/20] Train Acc: 0.8037, Loss: 0.0842, Val Acc: 0.9156, Loss: 0.3147
[6/20] Train Acc: 0.7841, Loss: 0.0839, Val Acc: 0.8846, Loss: 0.3707
[7/20] Train Acc: 0.8070, Loss: 0.0795, Val Acc: 0.9083, Loss: 0.3696
[8/20] Train Acc: 0.8102, Loss: 0.0797, Val Acc: 0.9179, Loss: 0.3258
[9/20] Train Acc: 0.8101, Loss: 0.0750, Val Acc: 0.9147, Loss: 0.3271
[10/20] Train Acc: 0.8210, Loss: 0.0737, Val Acc: 0.9293, Loss: 0.2944
[11/20] Train Acc: 0.8159, Loss: 0.0688, Val Acc: 0.9284, Loss: 0.2850
[12/20] Train Acc: 0.8147, Loss: 0.0689, Val Acc: 0.9279, Loss: 0.3087
[13/20] Train Acc: 0.8003, Loss: 0.0656, Val Acc: 0.9361, Loss: 0.2670
[14/20] Train Acc: 0.8399, Loss: 0.0624, Val Acc: 0.9307, Loss: 0.2684
[15/20] Train Acc: 0.8329, Loss: 0.0588, Val Acc: 0.9320, Loss: 0.2695
[16/20] Train Acc: 0.8227, Loss: 0.0548, Val Acc: 0.9352, Loss: 0.2387
[17/20] Train Acc: 0.8375, Loss: 0.0567, Val Acc: 0.9416, Loss: 0.2556
[18/20] Train Acc: 0.8244, Loss: 0.0544, Val Acc: 0.9425, Loss: 0.2323
[19/20] Train Acc: 0.8249, Loss: 0.0539, Val Acc: 0.9439, Loss: 0.2376
[20/20] Train Acc: 0.8198, Loss: 0.0522, Val Acc: 0.9416, Loss: 0.2370
Model deit_small best checkpoint saved at: checkpoints/deit_small_best.pth

=== Training model: swin_small ===
[1/20] Train Acc: 0.7683, Loss: 0.1019, Val Acc: 0.8946, Loss: 0.4416
[2/20] Train Acc: 0.7985, Loss: 0.0886, Val Acc: 0.9097, Loss: 0.3714
[3/20] Train Acc: 0.7905, Loss: 0.0856, Val Acc: 0.8914, Loss: 0.3503
[4/20] Train Acc: 0.8120, Loss: 0.0799, Val Acc: 0.9220, Loss: 0.3355
[5/20] Train Acc: 0.7967, Loss: 0.0760, Val Acc: 0.9138, Loss: 0.3105
[6/20] Train Acc: 0.7857, Loss: 0.0784, Val Acc: 0.9211, Loss: 0.3250
[7/20] Train Acc: 0.8058, Loss: 0.0730, Val Acc: 0.9302, Loss: 0.3049
[8/20] Train Acc: 0.8072, Loss: 0.0713, Val Acc: 0.9211, Loss: 0.2978
[9/20] Train Acc: 0.8117, Loss: 0.0736, Val Acc: 0.9316, Loss: 0.2711
[10/20] Train Acc: 0.8274, Loss: 0.0687, Val Acc: 0.9348, Loss: 0.2703
[11/20] Train Acc: 0.8310, Loss: 0.0687, Val Acc: 0.9361, Loss: 0.2652
[12/20] Train Acc: 0.8458, Loss: 0.0628, Val Acc: 0.9370, Loss: 0.2470
[13/20] Train Acc: 0.8377, Loss: 0.0617, Val Acc: 0.9357, Loss: 0.2675
[14/20] Train Acc: 0.8370, Loss: 0.0586, Val Acc: 0.9352, Loss: 0.2510
[15/20] Train Acc: 0.8479, Loss: 0.0574, Val Acc: 0.9439, Loss: 0.2418
[16/20] Train Acc: 0.8399, Loss: 0.0525, Val Acc: 0.9384, Loss: 0.2359
[17/20] Train Acc: 0.8375, Loss: 0.0564, Val Acc: 0.9434, Loss: 0.2294
[18/20] Train Acc: 0.8400, Loss: 0.0494, Val Acc: 0.9398, Loss: 0.2243
[19/20] Train Acc: 0.8528, Loss: 0.0502, Val Acc: 0.9393, Loss: 0.2144
[20/20] Train Acc: 0.8604, Loss: 0.0539, Val Acc: 0.9439, Loss: 0.2130
Model swin_small best checkpoint saved at: checkpoints/swin_small_best.pth

=== Training model: swin_v2_small ===
