Using device: cuda
Training directories: ['/workspace/hf_extracted_images/train', '/workspace/hf_extracted_images/test', '/workspace/synthetic/i2i', '/workspace/synthetic/t2i']
Models to train: ['convnext_small', 'efficientnet_b3']
Total samples: 21919, Train: 19727, Val: 2192

=== Training model: convnext_small ===
Resuming training from checkpoint: checkpoints/convnext_small_best.pth
[1/20] Train Acc: 0.7752, Loss: 0.1041, Val Acc: 0.8859, Loss: 0.4178
[2/20] Train Acc: 0.7745, Loss: 0.1012, Val Acc: 0.8891, Loss: 0.4427
[3/20] Train Acc: 0.7749, Loss: 0.1001, Val Acc: 0.9005, Loss: 0.4168
[4/20] Train Acc: 0.7742, Loss: 0.0951, Val Acc: 0.8878, Loss: 0.4214
[5/20] Train Acc: 0.7969, Loss: 0.0943, Val Acc: 0.9069, Loss: 0.4225
[6/20] Train Acc: 0.7827, Loss: 0.0925, Val Acc: 0.8745, Loss: 0.4275
[7/20] Train Acc: 0.7840, Loss: 0.0906, Val Acc: 0.9106, Loss: 0.4222
[8/20] Train Acc: 0.7941, Loss: 0.0875, Val Acc: 0.9138, Loss: 0.3841
[9/20] Train Acc: 0.7856, Loss: 0.0855, Val Acc: 0.9224, Loss: 0.3631
[10/20] Train Acc: 0.7928, Loss: 0.0852, Val Acc: 0.9097, Loss: 0.3399
[11/20] Train Acc: 0.7997, Loss: 0.0825, Val Acc: 0.9193, Loss: 0.3973
[12/20] Train Acc: 0.8071, Loss: 0.0775, Val Acc: 0.9197, Loss: 0.3618
[13/20] Train Acc: 0.8252, Loss: 0.0783, Val Acc: 0.9307, Loss: 0.3399
[14/20] Train Acc: 0.8019, Loss: 0.0781, Val Acc: 0.9275, Loss: 0.3131
[15/20] Train Acc: 0.8124, Loss: 0.0763, Val Acc: 0.9256, Loss: 0.3284
[16/20] Train Acc: 0.8228, Loss: 0.0717, Val Acc: 0.9352, Loss: 0.3015
[17/20] Train Acc: 0.8128, Loss: 0.0683, Val Acc: 0.9311, Loss: 0.3082
[18/20] Train Acc: 0.8088, Loss: 0.0710, Val Acc: 0.9261, Loss: 0.3029
[19/20] Train Acc: 0.8269, Loss: 0.0654, Val Acc: 0.9366, Loss: 0.2964
[20/20] Train Acc: 0.8194, Loss: 0.0650, Val Acc: 0.9348, Loss: 0.3035
Model convnext_small best checkpoint saved at: checkpoints/convnext_small_best.pth

=== Training model: efficientnet_b3 ===
Resuming training from checkpoint: checkpoints/efficientnet_b3_best.pth
[1/20] Train Acc: 0.8527, Loss: 0.0568, Val Acc: 0.9316, Loss: 0.2769
[2/20] Train Acc: 0.8374, Loss: 0.0563, Val Acc: 0.9411, Loss: 0.2686
[3/20] Train Acc: 0.8521, Loss: 0.0548, Val Acc: 0.9339, Loss: 0.3082
[4/20] Train Acc: 0.8218, Loss: 0.0573, Val Acc: 0.9316, Loss: 0.2673
[5/20] Train Acc: 0.8526, Loss: 0.0522, Val Acc: 0.9370, Loss: 0.2683
[6/20] Train Acc: 0.8255, Loss: 0.0524, Val Acc: 0.9434, Loss: 0.2417
[7/20] Train Acc: 0.8477, Loss: 0.0503, Val Acc: 0.9375, Loss: 0.3301
[8/20] Train Acc: 0.8518, Loss: 0.0502, Val Acc: 0.9375, Loss: 0.2831
[9/20] Train Acc: 0.8419, Loss: 0.0485, Val Acc: 0.9366, Loss: 0.3061
[10/20] Train Acc: 0.8503, Loss: 0.0494, Val Acc: 0.9398, Loss: 0.2832
