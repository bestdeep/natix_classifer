Using device: cuda
Training directories: ['/workspace/hf_extracted_images', '/workspace/synthetic', '/workspace/synthetic1']
Models to train: ['swin_large_patch4_window7_224']
Total samples: 29229, Train: 26306, Val: 2923

=== Training model: swin_large_patch4_window7_224 ===
TensorBoard logs -> tb_logs/swin_large_patch4_window7_224_20251021_050641
Resuming training from checkpoint: checkpoints/swin_large_patch4_window7_224_best.pth
Starting DANN pretraining for 10 epochs
[DANN pretrain 1/10] train_f1=0.9824 train_loss=0.1329 | val_acc=0.9483 val_loss=0.1587
Saved best pretrain checkpoint -> checkpoints/swin_large_patch4_window7_224_best.pth
[DANN pretrain 2/10] train_f1=0.9817 train_loss=0.1299 | val_acc=0.9487 val_loss=0.1552
Saved best pretrain checkpoint -> checkpoints/swin_large_patch4_window7_224_best.pth
[DANN pretrain 3/10] train_f1=0.9820 train_loss=0.1272 | val_acc=0.9487 val_loss=0.1638
[DANN pretrain 4/10] train_f1=0.9829 train_loss=0.1222 | val_acc=0.9453 val_loss=0.1572
[DANN pretrain 5/10] train_f1=0.9837 train_loss=0.1268 | val_acc=0.9466 val_loss=0.1643
[DANN pretrain 6/10] train_f1=0.9833 train_loss=0.1207 | val_acc=0.9487 val_loss=0.1623
[DANN pretrain 7/10] train_f1=0.9834 train_loss=0.1226 | val_acc=0.9473 val_loss=0.1607
[DANN pretrain 8/10] train_f1=0.9825 train_loss=0.1229 | val_acc=0.9466 val_loss=0.1633
[DANN pretrain 9/10] train_f1=0.9837 train_loss=0.1188 | val_acc=0.9477 val_loss=0.1601
[DANN pretrain 10/10] train_f1=0.9837 train_loss=0.1154 | val_acc=0.9446 val_loss=0.1713
Starting supervised training for 50 epochs
[Epoch 1/50] Train Acc: 0.9514, Loss: 0.0535 | Val Acc: 0.9470, Loss: 0.1605 Total Acc: 0.9492
Saved new best checkpoint -> checkpoints/swin_large_patch4_window7_224_best.pth
[Epoch 2/50] Train Acc: 0.9601, Loss: 0.0469 | Val Acc: 0.9466, Loss: 0.1459 Total Acc: 0.9534
Saved new best checkpoint -> checkpoints/swin_large_patch4_window7_224_best.pth
[Epoch 3/50] Train Acc: 0.9503, Loss: 0.0521 | Val Acc: 0.9483, Loss: 0.1431 Total Acc: 0.9493
[Epoch 4/50] Train Acc: 0.9561, Loss: 0.0460 | Val Acc: 0.9490, Loss: 0.1545 Total Acc: 0.9525
[Epoch 5/50] Train Acc: 0.9474, Loss: 0.0474 | Val Acc: 0.9494, Loss: 0.1435 Total Acc: 0.9484
[Epoch 6/50] Train Acc: 0.9470, Loss: 0.0457 | Val Acc: 0.9480, Loss: 0.1604 Total Acc: 0.9475
[Epoch 7/50] Train Acc: 0.9516, Loss: 0.0418 | Val Acc: 0.9477, Loss: 0.1545 Total Acc: 0.9497
[Epoch 8/50] Train Acc: 0.9494, Loss: 0.0403 | Val Acc: 0.9470, Loss: 0.1548 Total Acc: 0.9482
[Epoch 9/50] Train Acc: 0.9578, Loss: 0.0406 | Val Acc: 0.9483, Loss: 0.1477 Total Acc: 0.9531
[Epoch 10/50] Train Acc: 0.9482, Loss: 0.0433 | Val Acc: 0.9466, Loss: 0.1633 Total Acc: 0.9474
[Epoch 11/50] Train Acc: 0.9420, Loss: 0.0415 | Val Acc: 0.9470, Loss: 0.1634 Total Acc: 0.9445
[Epoch 12/50] Train Acc: 0.9537, Loss: 0.0398 | Val Acc: 0.9507, Loss: 0.1554 Total Acc: 0.9522
[Epoch 13/50] Train Acc: 0.9422, Loss: 0.0434 | Val Acc: 0.9446, Loss: 0.1677 Total Acc: 0.9434
[Epoch 14/50] Train Acc: 0.9502, Loss: 0.0389 | Val Acc: 0.9504, Loss: 0.1551 Total Acc: 0.9503
[Epoch 15/50] Train Acc: 0.9483, Loss: 0.0376 | Val Acc: 0.9518, Loss: 0.1675 Total Acc: 0.9500
[Epoch 16/50] Train Acc: 0.9432, Loss: 0.0412 | Val Acc: 0.9473, Loss: 0.1609 Total Acc: 0.9452
[Epoch 17/50] Train Acc: 0.9563, Loss: 0.0379 | Val Acc: 0.9473, Loss: 0.1622 Total Acc: 0.9518
[Epoch 18/50] Train Acc: 0.9567, Loss: 0.0362 | Val Acc: 0.9463, Loss: 0.1615 Total Acc: 0.9515
[Epoch 19/50] Train Acc: 0.9552, Loss: 0.0341 | Val Acc: 0.9473, Loss: 0.1706 Total Acc: 0.9513
[Epoch 20/50] Train Acc: 0.9553, Loss: 0.0365 | Val Acc: 0.9436, Loss: 0.1931 Total Acc: 0.9494
[Epoch 21/50] Train Acc: 0.9538, Loss: 0.0370 | Val Acc: 0.9470, Loss: 0.1714 Total Acc: 0.9504
[Epoch 22/50] Train Acc: 0.9554, Loss: 0.0359 | Val Acc: 0.9483, Loss: 0.1745 Total Acc: 0.9519
[Epoch 23/50] Train Acc: 0.9494, Loss: 0.0406 | Val Acc: 0.9494, Loss: 0.1655 Total Acc: 0.9494
[Epoch 24/50] Train Acc: 0.9489, Loss: 0.0392 | Val Acc: 0.9494, Loss: 0.1733 Total Acc: 0.9492
[Epoch 25/50] Train Acc: 0.9356, Loss: 0.0440 | Val Acc: 0.9466, Loss: 0.1771 Total Acc: 0.9411
[Epoch 26/50] Train Acc: 0.9497, Loss: 0.0393 | Val Acc: 0.9487, Loss: 0.1738 Total Acc: 0.9492
[Epoch 27/50] Train Acc: 0.9551, Loss: 0.0348 | Val Acc: 0.9480, Loss: 0.1738 Total Acc: 0.9516
[Epoch 28/50] Train Acc: 0.9505, Loss: 0.0379 | Val Acc: 0.9494, Loss: 0.1709 Total Acc: 0.9500
[Epoch 29/50] Train Acc: 0.9540, Loss: 0.0373 | Val Acc: 0.9477, Loss: 0.1801 Total Acc: 0.9508
[Epoch 30/50] Train Acc: 0.9518, Loss: 0.0339 | Val Acc: 0.9477, Loss: 0.1631 Total Acc: 0.9497
[Epoch 31/50] Train Acc: 0.9464, Loss: 0.0412 | Val Acc: 0.9449, Loss: 0.1793 Total Acc: 0.9457
[Epoch 32/50] Train Acc: 0.9512, Loss: 0.0375 | Val Acc: 0.9449, Loss: 0.1843 Total Acc: 0.9481
[Epoch 33/50] Train Acc: 0.9555, Loss: 0.0375 | Val Acc: 0.9453, Loss: 0.1808 Total Acc: 0.9504
[Epoch 34/50] Train Acc: 0.9610, Loss: 0.0329 | Val Acc: 0.9473, Loss: 0.1627 Total Acc: 0.9541
Saved new best checkpoint -> checkpoints/swin_large_patch4_window7_224_best.pth
[Epoch 35/50] Train Acc: 0.9616, Loss: 0.0319 | Val Acc: 0.9456, Loss: 0.1773 Total Acc: 0.9536
[Epoch 36/50] Train Acc: 0.9521, Loss: 0.0368 | Val Acc: 0.9501, Loss: 0.1636 Total Acc: 0.9511
[Epoch 37/50] Train Acc: 0.9526, Loss: 0.0378 | Val Acc: 0.9497, Loss: 0.1692 Total Acc: 0.9512
[Epoch 38/50] Train Acc: 0.9477, Loss: 0.0368 | Val Acc: 0.9477, Loss: 0.1682 Total Acc: 0.9477
[Epoch 39/50] Train Acc: 0.9475, Loss: 0.0368 | Val Acc: 0.9538, Loss: 0.1606 Total Acc: 0.9507
[Epoch 40/50] Train Acc: 0.9540, Loss: 0.0369 | Val Acc: 0.9494, Loss: 0.1702 Total Acc: 0.9517
[Epoch 41/50] Train Acc: 0.9495, Loss: 0.0389 | Val Acc: 0.9483, Loss: 0.1743 Total Acc: 0.9489
[Epoch 42/50] Train Acc: 0.9561, Loss: 0.0355 | Val Acc: 0.9528, Loss: 0.1770 Total Acc: 0.9544
Saved new best checkpoint -> checkpoints/swin_large_patch4_window7_224_best.pth
[Epoch 43/50] Train Acc: 0.9551, Loss: 0.0342 | Val Acc: 0.9436, Loss: 0.1686 Total Acc: 0.9493
[Epoch 44/50] Train Acc: 0.9485, Loss: 0.0374 | Val Acc: 0.9446, Loss: 0.1736 Total Acc: 0.9465
[Epoch 45/50] Train Acc: 0.9607, Loss: 0.0324 | Val Acc: 0.9480, Loss: 0.1876 Total Acc: 0.9543
[Epoch 46/50] Train Acc: 0.9534, Loss: 0.0366 | Val Acc: 0.9480, Loss: 0.1910 Total Acc: 0.9507
[Epoch 47/50] Train Acc: 0.9557, Loss: 0.0341 | Val Acc: 0.9453, Loss: 0.1768 Total Acc: 0.9505
[Epoch 48/50] Train Acc: 0.9542, Loss: 0.0346 | Val Acc: 0.9459, Loss: 0.1793 Total Acc: 0.9501
[Epoch 49/50] Train Acc: 0.9493, Loss: 0.0377 | Val Acc: 0.9446, Loss: 0.1832 Total Acc: 0.9470
[Epoch 50/50] Train Acc: 0.9555, Loss: 0.0352 | Val Acc: 0.9456, Loss: 0.1908 Total Acc: 0.9506
Model swin_large_patch4_window7_224 best checkpoint saved at: checkpoints/swin_large_patch4_window7_224_best.pth
